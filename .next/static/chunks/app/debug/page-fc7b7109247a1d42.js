(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9302],{7133:(e,s,a)=>{"use strict";a.d(s,{SQ:()=>u,_2:()=>x,lp:()=>f,mB:()=>h,rI:()=>c,ty:()=>m});var t=a(5155),n=a(2115),l=a(8698),r=a(3052),d=a(5196),i=a(9428),o=a(3999);let c=l.bL,m=l.l9;l.YJ,l.ZL,l.Pb,l.z6,n.forwardRef((e,s)=>{let{className:a,inset:n,children:d,...i}=e;return(0,t.jsxs)(l.ZP,{ref:s,className:(0,o.cn)("flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",n&&"pl-8",a),...i,children:[d,(0,t.jsx)(r.A,{className:"ml-auto"})]})}).displayName=l.ZP.displayName,n.forwardRef((e,s)=>{let{className:a,...n}=e;return(0,t.jsx)(l.G5,{ref:s,className:(0,o.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...n})}).displayName=l.G5.displayName;let u=n.forwardRef((e,s)=>{let{className:a,sideOffset:n=4,...r}=e;return(0,t.jsx)(l.ZL,{children:(0,t.jsx)(l.UC,{ref:s,sideOffset:n,className:(0,o.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...r})})});u.displayName=l.UC.displayName;let x=n.forwardRef((e,s)=>{let{className:a,inset:n,...r}=e;return(0,t.jsx)(l.q7,{ref:s,className:(0,o.cn)("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",n&&"pl-8",a),...r})});x.displayName=l.q7.displayName,n.forwardRef((e,s)=>{let{className:a,children:n,checked:r,...i}=e;return(0,t.jsxs)(l.H_,{ref:s,className:(0,o.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),checked:r,...i,children:[(0,t.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,t.jsx)(l.VF,{children:(0,t.jsx)(d.A,{className:"h-4 w-4"})})}),n]})}).displayName=l.H_.displayName,n.forwardRef((e,s)=>{let{className:a,children:n,...r}=e;return(0,t.jsxs)(l.hN,{ref:s,className:(0,o.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...r,children:[(0,t.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,t.jsx)(l.VF,{children:(0,t.jsx)(i.A,{className:"h-2 w-2 fill-current"})})}),n]})}).displayName=l.hN.displayName;let f=n.forwardRef((e,s)=>{let{className:a,inset:n,...r}=e;return(0,t.jsx)(l.JU,{ref:s,className:(0,o.cn)("px-2 py-1.5 text-sm font-semibold",n&&"pl-8",a),...r})});f.displayName=l.JU.displayName;let h=n.forwardRef((e,s)=>{let{className:a,...n}=e;return(0,t.jsx)(l.wv,{ref:s,className:(0,o.cn)("-mx-1 my-1 h-px bg-muted",a),...n})});h.displayName=l.wv.displayName},8388:(e,s,a)=>{Promise.resolve().then(a.bind(a,9685))},9663:(e,s,a)=>{"use strict";a.d(s,{BK:()=>i,eu:()=>d,q5:()=>o});var t=a(5155),n=a(2115),l=a(4011),r=a(3999);let d=n.forwardRef((e,s)=>{let{className:a,...n}=e;return(0,t.jsx)(l.bL,{ref:s,className:(0,r.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",a),...n})});d.displayName=l.bL.displayName;let i=n.forwardRef((e,s)=>{let{className:a,...n}=e;return(0,t.jsx)(l._V,{ref:s,className:(0,r.cn)("aspect-square h-full w-full",a),...n})});i.displayName=l._V.displayName;let o=n.forwardRef((e,s)=>{let{className:a,...n}=e;return(0,t.jsx)(l.H4,{ref:s,className:(0,r.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",a),...n})});o.displayName=l.H4.displayName},9685:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>b});var t=a(5155),n=a(2115),l=a(8482),r=a(6888),d=a(3398),i=a(7168),o=a(9852),c=a(838),m=a(5695);let u=e=>fetch(e).then(e=>e.json());function x(){let{data:e,error:s,isLoading:a,mutate:t}=(0,c.Ay)("/api/auth/status",u),n=(0,m.useRouter)(),l=async()=>{await fetch("/api/auth/logout",{method:"POST"}),await t({isLoggedIn:!1,user:void 0},!1),n.push("/")};return{user:null==e?void 0:e.user,isLoggedIn:!!(null==e?void 0:e.isLoggedIn),isLoading:a,error:s,logout:l,mutate:t}}function f(e){let{onLoginSuccess:s}=e,[a,r]=(0,n.useState)("ankunstudio"),[c,m]=(0,n.useState)("admin"),[u,f]=(0,n.useState)(!1),[h,p]=(0,n.useState)(""),{mutate:j}=x(),g=async()=>{f(!0),p("Đang đăng nhập...");try{let e=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:a,password:c})}),t=await e.json();t.success&&t.data?(p("✅ Đăng nhập th\xe0nh c\xf4ng! Role: ".concat(t.data.role)),d.v.info("Test login successful",{userId:t.data.id}),await j(),s(t.data)):(p("❌ Đăng nhập thất bại: ".concat(t.message||"Kiểm tra lại th\xf4ng tin")),d.v.warn("Test login failed",{reason:t.message}))}catch(s){let e=s instanceof Error?s.message:"Lỗi kh\xf4ng x\xe1c định";p("\uD83D\uDEA8 Lỗi kết nối: ".concat(e)),d.v.error("Test login error:",s)}finally{f(!1)}};return(0,t.jsxs)(l.Zp,{className:"w-full max-w-md mx-auto",children:[(0,t.jsx)(l.aR,{children:(0,t.jsx)(l.ZB,{children:"\uD83E\uDDEA Test Authentication"})}),(0,t.jsxs)(l.Wu,{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-medium",children:"Username:"}),(0,t.jsx)(o.p,{value:a,onChange:e=>r(e.target.value),placeholder:"ankunstudio"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-medium",children:"Password:"}),(0,t.jsx)(o.p,{type:"password",value:c,onChange:e=>m(e.target.value),placeholder:"admin"})]}),(0,t.jsx)(i.$,{onClick:g,disabled:u,className:"w-full",children:u?"Đang đăng nhập...":"Đăng nhập"}),h&&(0,t.jsx)("div",{className:"p-3 rounded text-sm ".concat(h.includes("✅")?"bg-green-100 text-green-800":h.includes("❌")||h.includes("\uD83D\uDEA8")?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"),children:h}),(0,t.jsxs)("div",{className:"text-xs text-gray-500 space-y-1",children:[(0,t.jsx)("p",{children:(0,t.jsx)("strong",{children:"Test Data:"})}),(0,t.jsx)("p",{children:"Username: ankunstudio"}),(0,t.jsx)("p",{children:"Password: admin"}),(0,t.jsx)("p",{children:"Expected Role: Label Manager"})]})]})]})}var h=a(7133),p=a(9663),j=a(306),g=a(1007),N=a(4835),v=a(3999);function y(e){let{className:s,...a}=e;return(0,t.jsx)("div",{className:(0,v.cn)("animate-pulse rounded-md bg-muted",s),...a})}function w(){let{user:e,isLoggedIn:s,isLoading:a,logout:n}=x(),l=(0,m.useRouter)();return a?(0,t.jsx)(y,{className:"h-10 w-10 rounded-full"}):s&&e?(0,t.jsxs)(h.rI,{children:[(0,t.jsx)(h.ty,{asChild:!0,children:(0,t.jsx)(i.$,{variant:"ghost",className:"relative h-10 w-10 rounded-full",children:(0,t.jsxs)(p.eu,{className:"h-10 w-10",children:[(0,t.jsx)(p.BK,{src:e.avatar,alt:e.username}),(0,t.jsx)(p.q5,{children:e.username.charAt(0).toUpperCase()})]})})}),(0,t.jsxs)(h.SQ,{className:"w-56",align:"end",forceMount:!0,children:[(0,t.jsx)(h.lp,{className:"font-normal",children:(0,t.jsxs)("div",{className:"flex flex-col space-y-1",children:[(0,t.jsx)("p",{className:"text-sm font-medium leading-none",children:e.fullName}),(0,t.jsx)("p",{className:"text-xs leading-none text-muted-foreground",children:e.email})]})}),(0,t.jsx)(h.mB,{}),(0,t.jsxs)(h._2,{children:[(0,t.jsx)(g.A,{className:"mr-2 h-4 w-4"}),(0,t.jsx)("span",{children:"Trang c\xe1 nh\xe2n"})]}),(0,t.jsx)(h.mB,{}),(0,t.jsxs)(h._2,{onClick:n,children:[(0,t.jsx)(N.A,{className:"mr-2 h-4 w-4"}),(0,t.jsx)("span",{children:"Đăng xuất"})]})]})]}):(0,t.jsxs)(i.$,{variant:"outline",onClick:()=>l.push("/"),children:[(0,t.jsx)(j.A,{className:"mr-2 h-4 w-4"})," Đăng nhập"]})}function b(){let[e,s]=(0,n.useState)(null);return(0,t.jsxs)("div",{className:"container mx-auto py-8 space-y-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold",children:"AKs Studio Test Console"}),(0,t.jsx)(w,{})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,t.jsxs)("div",{className:"md:col-span-1 space-y-4",children:[(0,t.jsx)(f,{onLoginSuccess:e=>{d.v.info("Login success on debug page",{userId:e.id},{component:"TestPage"}),s(e)}}),e&&(0,t.jsxs)(l.Zp,{className:"w-full mt-4",children:[(0,t.jsx)(l.aR,{children:(0,t.jsx)(l.ZB,{children:"\uD83D\uDC64 User Info"})}),(0,t.jsx)(l.Wu,{children:(0,t.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"ID:"})," ",e.id]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Username:"})," ",e.username]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Role:"})," ",e.role]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Email:"})," ",e.email]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Full Name:"})," ",e.fullName]}),e.isrcCodePrefix&&(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"ISRC Prefix:"})," ",e.isrcCodePrefix]})]})})]})]}),(0,t.jsx)("div",{className:"md:col-span-2",children:(0,t.jsx)(r.K,{})})]})]})}}},e=>{e.O(0,[3322,7655,1031,9434,8803,1666,6888,8441,5964,7358],()=>e(e.s=8388)),_N_E=e.O()}]);